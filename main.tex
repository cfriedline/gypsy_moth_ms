\documentclass[fleqn,11pt]{wlpeerj}
\usepackage{lineno}
\usepackage{url}
\usepackage[htt]{hyphenat}

\title{The ecological genomics of gypsy moth invasion along a latitudinal
gradient}

\author[1]{Christopher J. Friedline}
\author[1]{Trevor M. Faske}
\author[1]{Erin M. Hobson}
\author[2]{Dylan Parry}
\author[1]{Derek M. Johnson}
\author[3]{Lily M. Thompson}
\author[3,*]{Kristine L. Grayson}
\author[1,*,\textdagger]{Andrew J. Eckert}
\affil[1]{Department of Biology, Virginia Commonwealth University}
\affil[2]{College of Environmental Science and Forestry, State University of
New York}
\affil[3]{Department of Biology, University of Richmond}
\affil[*]{Author contributed equally}
\affil[ \textdagger]{Corresponding author}

\keywords{}

\begin{abstract}
TODO
\end{abstract}

\begin{document}

\flushbottom
\maketitle
\thispagestyle{empty}

\linenumbers%

\section*{Introduction}
TODO


\section*{Methods}

\subsection*{Sampling}

(State where climate data came from here)

\subsection*{Phenotype determination}

\subsection*{Library preparation and sequencing}

Genomic DNA extracted using Qiagen DNeasy Plant Mini kit (Qiagen, cat \# 69104)
according to manufacturer's protocol.  The library was prepared and sequenced as
a single run of paired-end reads on the Illumina HiSeq 2500 platform at the
Virginia Commonwealth Univesrity Nucleic Acids Research Facility. Quality was
initially assessed using FastQC \citep{fastqc} and subsequently processed with
IPython~\citep{Perez:2007hy} and BioPytho~\citep{Cock:2009hj}. The read pairs
were each evaluated along sliding windows of 5 bp.  If the mean score in this
window was below a score of 30, the read was trimmed at that beginning of the
window. If the shortened read was less than 50\% of the length of the original
read, it was discarded along with its pair. Additionally, if 20\% of the bases
in a read had quality values less than 30, it was discarded along with its pair.

\subsection*{Draft assembly}

An assembly was produced for the purpose of variant calling and is not
considered as a candidate for complete genomic assembly. The quality-filtered
reads from the paired-end sequencing library was used as input into
\texttt{MaSuRCA} \citep[][version 2.3.2]{Zimin:2013kn}, with the following
parameters changed from the defaults: mean/standard deviation of read length:
400/60, use linking mates: 1: cgwErrorRate: 0.15.  Quality of the assembly was
assessed using the statistics generated by the assembly process, as well as with the
\texttt{BUSCO} \citep[][version 1.1b1]{Simao:2015kk} toolset. For
\texttt{BUSCO}, the software was built automatically using a Docker image (see
GitHub repository information below). The assembly was evaluated against
pre-computed \texttt{Augustus} \citep{Stanke:2003eo} metaparameters of  three
species (\textit{Aedes}, \textit{Heliconius}, and \textit{Drosophila}) and the
BUSCO Arthropoda lineage profile using a \texttt{tblastn} e-value cutoff of
$0.001$.

\subsection*{Sequence processing and variant calling} Sequencing of 192
individual moths, exclusive of the one used for assembly,  as performed on
reduced genomic DNA per~\cite{PARCHMAN:2012ca}. In total, two  Illumina HiSeq
2500 lanes were sequenced. Bases with quality scores less than 33 were masked,
per~\cite{Yun:2014dn},  using \texttt{fastq\_masker} from the FastX toolkit
\citep[][version 0.0.14]{citeulike:9103573}.

Masked fastq files were mapped using \texttt{bowtie2}~\citep[][version
2.2.4]{Langmead:2012jh}, using flags  \texttt{--local
--very-sensitive-local}.  The resulting  SAM files were converteted to their
binary equivalent, sorted, and indexed. To each of these indexed bam files,
appropriate \texttt{RG} ID and sample information was added using
\texttt{picard} \\ (\url{https://broadinstitute.github.io/picard}), version 1.112
to inform variant calling.

Duplicates were marked using \texttt{Picard} and the resulting files were
indexed using \texttt{samtools} \citep[][version 1.2]{Li:2009ka}.  Sequence
variants were called using samtools and bcftools \citep[][version
1.2]{Li:2009ka} with individual  ploidy level set to \texttt{2} for all samples.
The variants were filtered  using \texttt{vcftools}~\citep[][version
0.1.14]{Danecek:2011gz}, such that only diallelic single nucleotide polymorphisms (SNPs) remained in cases where a
variant call was present in at least 50\% of the samples and the minimum
gentoype quality (\texttt{--minQG}) of 3. An additional filtering using
\texttt{vcfutils.pl} (from \texttt{bcftools}) was performed to only keep sites
with mapping qualities of at least 10 (\texttt{varFilter -Q 10}). The vcf file
was then double checked to ensure all reference and alternate alleles were
single nucleotides before imputation with \texttt{Beagle}
\citep[][version 4.0, r1399]{Browning:2007ge}.  The impuation was performed on 30 CPUs
using the following non-default parameters: \texttt{phase-its=20, burnin-its=20,
impute-its=20}.

For each set of imputed (IMP) and non-imputed (NI) SNPs, the following filtering
was performed.  First, \texttt{VCFtools} was used to include only bialleleic
SNPs (\texttt{--min-alleles=2, --max-alleles=2}), SNPs with minor allele
frequency (MAF) of at least 1\% (\texttt{--mac=0.01}) and SNPs present in at
least 50\% of the samples (\texttt{--max-missing=0.5}).  Additional MAF
(correcting for  finite population size) and percent missing filtering was done
using Python following removal of duplicate samples from the variant data and
Depth across samles (DP), Alternate allele call quality (QUAL), and RMS mapping
quality values (MQ), reported in the VCF file were examined.  An additional
filtering step was conducted using \texttt{vcfutils.pl} (from \texttt{bcftools})
to remove SNPs with MQ values less than 10.  Monomorphic SNPs were removed as
well as SNPs with $F_{IS} < -0.5$ or $F_{IS} > 0.5$.  We only considered SNPs
to be valid if they passed filtering in both the IMP and NI datasets. Finally,
SNPs were oriented according to dosage of globally-minor allele, rather than
alternate allele with respect to the assembly. In other words, in a file of
genotypes where 0/1/2 would normally represent counts of alternate allele in a
diploid genotype,  (as output by \texttt{vcftools}), 0/1/2 were recoded to
represent counts of the minor allele (i.e., a genotype of 2 indicates two copies
of the globally minor allele). This ``swapped'' representation was then used as
input for downstream analysis.

\subsection*{Patterns of phenotypic and genetic variation}

Values for each phenotypic trait were summarized  within populations using
parametric summary statistics (i.e., means and variances). Differentiation among
populations for phenotypic traits was assessed using Multivariate Analysis of
Variance (MANOVA). Statistical significance of the MANOVA model was determined
using Wilk's lambda as the test statistic and $\alpha = 0.05$. We subsequently
used one-way Analysis of Variance (ANOVA) to assess differentiation separately
for each phenotypic trait. We treated population identifiers as a fixed effect
for statistical hypothesis testing ($\alpha = 0.05$), but as a random effect for
estimation of variance components. Variance components were used to construct a
measure of phenotypic differentiation akin to hierarchical $F$-statistics.
Specifically, we used the ratio of the variance due to population identifiers to
the total phenotypic variance ($P_{ST}$) as a measure of phenotypic
differentiation. All analysis was conducted using the \texttt{stats} and
\texttt{lme4} libraries of R ver. 3.1.2 (R Core Team 2014). Lastly, we used
partial redundancy analysis (pRDA) to describe the effect of climate and
geography on phenotypic trait values. We partitioned the variance due to climate
and geography using standard variance partitioning methods \citep{Borcard:1992}.
Geography was quantified using Moran eigenvector maps (MEMs) as determined using
the \texttt{pcnm} function in the \texttt{vegan} ver. 2.2-1 library of R. We
used all eigenvectors with positive eigenvalues to describe geography. Input to
the \texttt{pcnm} function was a matrix of pairwise geographical distances among
populations, where geographical distance was calculated as great circle
distances (km) using the \texttt{geosphere} library in R.

Patterns of genetic variation within and among populations were described using
standard population genetic indices: observed ($H_{obs}$) and expected
($H_{exp}$) heterozygosities, Wright's inbreeding coefficient ($F$), and
hierarchical $F$-statistics (e.g. $F_{ST}$). Estimates were made for each SNP
and all SNPs combined using the \texttt{hierfstat} library in R. Confidence
intervals ($95\%$) for multilocus estimates were generated using bootstrapping
across SNPs ($n = 1,000$). Genetic structure among populations was also assessed
using principal components analysis (PCA) following~\cite{Patterson:2006}.
Significance of principal components (PCs) was assessed using Tracy-Widom tests
with $\alpha = 0.05$.

\subsection*{Genome-wide association analyses}
(This section should be for phenotypes (piMASS) and environments (Bayenv2))

\subsection*{Genetic architecture and selection}
TODO

\section*{Results}

\subsection*{Draft assembly and DNA sequence analysis}
TODO

\subsection*{Patterns of phenotypic and genetic variation}
TODO

\subsection*{Genome-wide association analyses}
TODO

\subsection*{Genetic architecture and selection}
TODO

\section*{Discussion}
TODO


\section*{Conclusion}
TODO


\section*{Figures}
TODO

\section*{Tables}
TODO

\section*{Supplementary material}
TODO

\clearpage
\bibliography{refs}

\end{document}
